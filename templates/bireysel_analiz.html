{% extends "base.html" %}

{% block content %}
<div class="container">
    <h2>NUMEROLOJİ-EBCED HESAPLAMA</h2>
    
    <div class="tabs">
        <a href="{{ url_for('bireysel_analiz') }}" class="tab active">Bireysel Analiz</a>
        <a href="{{ url_for('iliski_analizi') }}" class="tab">İlişki Analizi</a>
        <a href="{{ url_for('sure_hesaplama') }}" class="tab">Sure Hesaplama</a>
    </div>

    <div class="form-container">
        <h3>Bilgiler</h3>
        <p class="info">Doğum tarihinizi seçebilir veya elle girebilirsiniz. (Örn: 09.02.2003 veya 09/02/2003 veya 09 02 2003)</p>
        
        <form method="POST" action="{{ url_for('bireysel_analiz') }}">
            <div class="form-group">
                <label for="dogum_gunu">Doğum Tarihi</label>
                <input type="text" id="dogum_gunu" name="dogum_gunu" placeholder="GG.AA.YYYY veya GG/AA/YYYY" required>
                <input type="date" id="date_picker" onchange="updateDateInput(this.value)">
            </div>
            
            <div class="form-group">
                <label for="isim_soyisim">İsim Soyisim</label>
                <input type="text" id="isim_soyisim" name="isim_soyisim" placeholder="İsim soyisim" required>
            </div>
            
            <div class="form-group">
                <label for="eklenen_isim">Ek İsim (evlilik ismi veya kişiye eklenecek isim)</label>
                <input type="text" id="eklenen_isim" name="eklenen_isim" placeholder="Eklenen isim (isteğe bağlı)">
            </div>
            
            <button type="submit" class="submit-btn">Gönder</button>
        </form>
    </div>

    {% if results %}
    <div class="results">
        <h3>Girdiler:</h3>
        <div class="result-section">
            <p><strong>Doğum Tarihi:</strong> {{ results.input_dogum_gunu }}</p>
            <p><strong>İsim Soyisim:</strong> {{ results.isim_soyisim }}</p>
            {% if results.eklenen_isim %}
            <p><strong>Ek İsim:</strong> {{ results.eklenen_isim }}</p>
            {% endif %}
        </div>
        
        <h3>Sonuçlar:</h3>
        
        <div class="result-section">
            <h4>Yaşam Yolu:</h4>
            <p>{{ results.yasam_yolu }}</p>
        </div>

        <div class="result-section" style="background-color: #ffffff;">
            <div class="accordion-item">
                <button class="accordion-button" onclick="toggleAccordion(this)">
                    Yaşam Yolu Açıklaması
                    <span class="accordion-icon">▼</span>
                </button>
                <div class="accordion-content">
                    <pre>{{ results.yasam_yolu_aciklama | safe }}</pre>
                </div>
            </div>
        </div>

        <div class="result-section">
            <h4>Bereket Sayısı:</h4>
            <p>{{ results.bereket_sayisi }}</p>
        </div>

        <div class="result-section">
            <h4>Pin Kodu:</h4>
            <div class="pin-kodu-tablosu">
                <table>
                    <tr>
                        <td>{{ results.dogum_gunu.split(' ')[0] }}</td>
                        <td>{{ results.dogum_gunu.split(' ')[1] }}</td>
                        <td>{{ results.dogum_gunu.split(' ')[2] }}</td>
                        <td></td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>{{ results.pin_kodu_dizilimi[0]}}</td>
                        <td>{{ results.pin_kodu_dizilimi[1] }}</td>
                        <td>{{ results.pin_kodu_dizilimi[2] }}</td>
                        <td>{{ results.pin_kodu_dizilimi[3] }}</td>
                        <td>{{ results.pin_kodu_dizilimi[4] }}</td>
                    </tr>
                    <tr>
                        <td></td>
                        <td>{{ results.pin_kodu_dizilimi[5] }}</td>
                        <td>{{ results.pin_kodu_dizilimi[6] }}</td>
                        <td></td>
                        <td></td>
                    </tr>
                    <tr>
                        <td></td>
                        <td></td>
                        <td>{{ results.pin_kodu_dizilimi[7]}}</td>
                        <td></td>
                        <td></td>
                    </tr>
                    <tr>
                        <td></td>
                        <td></td>
                        <td>{{ results.pin_kodu_dizilimi[8] }}</td>
                        <td></td>
                        <td></td>
                    </tr>
                </table>
            </div>
        </div>
        
        <div class="result-section" style="background-color: #ffffff;">
            <h4>Pin Kodu Yorumları:</h4>
            {% for yorum in results.pin_kodu_yorumlari %}
            <div class="accordion-item">
                <button class="accordion-button" onclick="toggleAccordion(this)">
                    {{ loop.index }}. Hane Yorumu
                    <span class="accordion-icon">▼</span>
                </button>
                <div class="accordion-content">
                    {{ yorum | safe }}
                </div>
            </div>
            {% endfor %}
        </div>

        <div class="result-section">
            <h4>Çakra Dağılımı:</h4>
            <div class="chakra-table">
                <table>
                    {% for chakra in results.chakra %}
                    <tr>
                        <td class="plus-cell">{{ chakra.left_plus }}</td>
                        <td class="number-cell">{{ chakra.number }}</td>
                        <td class="plus-cell">{{ chakra.right_plus }}</td>
                        {% if chakra.has_ek_isim %}
                        <td class="separator-cell">|</td>
                        <td class="ek-plus-cell">{{ chakra.ek_plus }}</td>
                        {% endif %}
                        <td class="pin-code-cell">{{ results.pin_kodu_dizilimi[9 - loop.index] }}</td>
                    </tr>
                    {% endfor %}
                </table>
            </div>
        </div>

        {% if results.chakra_yorumlari %}
        <div class="result-section" style="background-color: #ffffff;">
            <h4>Çakra Yorumları:</h4>
            {% for yorum in results.chakra_yorumlari %}
            <div class="accordion-item">
                <button class="accordion-button" onclick="toggleAccordion(this)">
                    {{ loop.index }}. Çakra Yorumu
                    <span class="accordion-icon">▼</span>
                </button>
                <div class="accordion-content">
                    <pre>{{ yorum | safe }}</pre>
                </div>
            </div>
            {% endfor %}
        </div>
        {% endif %}

        <div class="result-section">
            <h4>Merkez Sayı / Ana kulvar: (ek isim dahil değil)</h4>
            <p><strong>{{ results.merkez_sayi }}</strong></p>
            <div>
                <pre>{{ results.merkez_sayi_sonuc }}</pre>
            </div>
        </div>

        <div class="result-section">
            <h4>Tam Kulvar: (Bütün harflerin toplamı)</h4>
            <p>{{ results.tam_kulvar }}</p>
        </div>

        

        <div class="result-section">
            <h4>Dönüşüm Yılları:</h4>
            <pre>{{ results.donusum_yillari }}</pre>

            <div class="accordion-item">
                <button class="accordion-button" onclick="toggleAccordion(this)">
                    Dönüşüm Yılları Bilgi:
                    <span class="accordion-icon">▼</span>
                </button>
                <div class="accordion-content">
                    <pre>Dönüşüm yılları:
    Bir kişi uzun zamanlarda bir dönüşüm yaşıyorsa ya da aynı aralıkta aynı sayı ile dönüşüyorsa bu kişinin inatçı olduğunu, zoor öğrendiğini, kabul etmek istemediğini gösterebilir. aynı zamanda o haneden çok çetin zor bir imtihan yaşıyor ve orayı atlatamıyor olabilir. Tekrar tekrar üzerinden geçiyor olabilir.

    Eğer kişi 3-5 yılda bir dönüşüm yaşıyor ise bu kişi daha kolay bir öğrenme kabiliyetine sahiptir. Dönüşüm yılları o yılın içinde kendi doğum tarihimizden sonra geçerli olmaya başlar. 11/2* ya da 22/4* gibi sayılar çıktığı zaman extra zorluk demektir.

    1 ile dönüşüm: Liderlik, eril enerji, kök çakra ve iskelet sistemi, kendini görme, doğum ( 1 anneyi bedenen zorlamış) , evlenme, boşanma, manevi bir alana girme, mal-mülk alma, toprak alma demektir. (parayı kazanacak demektir.)

    2 ile dönüşüm: Dişil enerji, üretim, doğurganlık , cinsellik ,sevgi sevgi enerjisi, aşık olma potansiyeli platonik aşk, kişi duygusal bir dönemdedir, duygusal yaklaşmak gerekir, ortaklık kurmak da demektir. sevgi arayışı, Dişi figürlerden destek görme (anne-abla-arkadaş).

    3 ile dönüşüm: 3 dönüşüm yılında kişi keyifli muhabbetlerden hoşlanır. Medyatik işler, iletişim, sanal alem, sosyal medya, bakış açısı. Meslek sahibi olma, iletişim yönünde dilini şikayetten ve yakınmaktan korumalı, kusur ve eleştiren kaçınılmalı. Eğer 3'ün pozitif yanını yaşamak istiyorsa dilini insanların iyiliğine kullanmalı.

    4 ile dönüşüm: Genel olarak 4 yıllarımız da zorlanırız. Ruhumuzda yer alan bir hasar olursa ruhen dönüşüm yaşarız. Zorlandırığımız yıllarda ya 4 etkisi vardır ya da açan hanede 4 etkisi vardır illa dönüşüm yaşamak zorunda değiliz. Sabır, sebat, zorlanma, öğrenme, eğitim. Bu dönüşüm yılındaysa kişi ciddi olarak konuşmalı ve uzatmadan özet olarak söylemeli kişi sabırsızdır. yıkım ve yeniden düzen kurma yılıdır, kişinin sorumlulukları artar yeniden bir düzen kurar. Mesela, kişinin babasının hastalıkları artabilir, ağır bir rahatsızlık geçirebilir.

    5 ile dönüşüm: Şükür enerjisi, sevgi enerjisi, yükseliş. Gezme tozma, keyif, eğlence, bolca alışveriş yapma, para harcama, farklı farklı kültürler tanıma. Kişiye iş olarak yükseliş ve başarı da verebilir. (Kişinin 5. Çakrası nasıl nasıl çalışıyor ve pin kodunun 5. Hanesinde hangi rakam olduğu çok önemlidir.) Aynı zamanda bu yükseliş mabinevi anlamda da olabilir. 5 dönüşüm yıllarında kişinin kendini eve kapatıp isyan etmeye meyilli vardır. O yüzden dikkat etmeli , şükür enerjisinden kalmalı. Dönüşüm yılları ardı ardına 5 çıkıyorsa kişinin olaylara pozitif yanıyla bakması, şükür konusunda ekstra dikkat etmesi ve bu yaşadığım olay beni ne kadar yükseltti uyandırdı diye sorgulaması iyi yanından bakması gerekir. 5 sayısının pozitif dönüşüm / negatif dönüşüm etkisi vardır bu ayrıma kişinin hangi sayılarla ve pin kodunda 5. Haneye ardından 5. Çakrasına bakarak yorum yapılır. 14/5 ile dönüşüm yaşıyor ise 4 öğrenmek 1 bireysel 5 eğlenerek öğrenmek diye yorumlayabiliriz.

    6 ile dönüşüm: Sorumluluk alma, evlilik, çocuk. Ailesinden, babasından, hanımından, çocuğundan, evlenme potansiyeline bahsedeceğiz. (Kişi genç ise doğum hamilelik-doğum olabilir) bir şey kurmak, bir şey başlatmak, aşk ihtimali. Doğum, kayıp, ölüm, baba ile imtihan.

    7 ile dönüşüm: Huzur ve arayıştır. Maneviyat olarak kendi içine çekil, kendini tanı, özün dön, kalabalıklar içinde kendini yalnız hissetme, bireysel başarıya önem verilmeli. Aynı zamanda spiritüel alanlara yönelme. 7 yılında altına imza attığın her şeye dikkat et. Davet edildiği her yere katılmaya özen göster, her davette bir fırsat yakalayabilirsin. Yaptığın iyiliklerin karşılığını o yıl bekleme bir sonraki yıl fazla fazla alırsın. Maddi olarak karşılığı az olan işlerde dahi yardım et ve bir sonraki yıl karşılığını bekle. Kişi ne istiyor karar vermeli, yardım kuruluşlarında gönüllü yer alabilir. Kendi içine çekilip maneviyatını güçlendirebilir. Para istiyor ise yatırım yapmalı ama para akışı bir sonraki yıl artar. Pin kodunda 7. Hane 3 ile açılıyorsa iletişim anlamında, ortaklı iş yapma, sözleşmeler, her davete katılma konusunda çalışır.

    8 ile dönüşüm: Ruh, güç, otorite, korunma, makam-mevkii, şöhret, bereket, para-pul, aynı zamanda yer değişikliği de olabilir. Bir yıl öncesinden ne verdiysen katlayarak sana geri verir. Eğer bir önceki yılı yanlış değerlendirdiysen 8 yılı yıkım olabilir, maddi zarar olabilir. İyi değerlendirdiysen bol kazanç ve yükseliş yaşarsın. Bir iş yeri başka şubeler açabilir ya da yeni bir iş yeri açma, yeni bir işte yükselme çok karlı projeler yaparak yüklü kazançlar olabilir.

    9 ile dönüşüm: Kişiye şifalanacağı alanlardan bahsedebiliriz, bitişler ve kayıplar olabilir, bitiş demektir. Sınırları korumak ile alakalıdır. 9 dönüşüm yılında yeni bir işe başlanacak eğer kişinin pin kodunda 9. haneye bakarız eğer 1 varsa o kişi için olumludur benlik, bireysellik, liderlik konusunda şifalanma diyebiliriz. Düzenli olarak tahliller yaptırmasını, ihtiyacına göre tedavilere yönelerek ( hacamat, sülük, bilinçaltı vb.) şifalanabilir gibi tavsiyeler verebiliriz.
    
    NOT: Kişinin dönüşüm yılındaki rakamın pin koduna ve çakra dağılımdaki + lara bakarsak çok daha detaylı bilgiye ulaşabilirsiniz.
                    </pre>
                </div>
            </div>
        </div>

        <div class="result-section">
            <h4>Mizaç Özellikleri:</h4>
            <div class="mizac-tablosu">
                <table>
                    <thead>
                        <tr>
                            <th></th>
                            <th >esnek</th>
                            <th >katı</th>
                            <th >baskın</th>
                            <th >edilgen</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>hava</strong></td>
                            <td>{{ results.pin_kodu_ozellikleri.hava.esnek }}</td>
                            <td>{{ results.pin_kodu_ozellikleri.hava.katı }}</td>
                            <td>{{ results.pin_kodu_ozellikleri.hava.baskın }}</td>
                            <td>{{ results.pin_kodu_ozellikleri.hava.edilgen }}</td>
                        </tr>
                        <tr>
                            <td><strong>su</strong></td>
                            <td>{{ results.pin_kodu_ozellikleri.su.esnek }}</td>
                            <td>{{ results.pin_kodu_ozellikleri.su.katı }}</td>
                            <td>{{ results.pin_kodu_ozellikleri.su.baskın }}</td>
                            <td>{{ results.pin_kodu_ozellikleri.su.edilgen }}</td>
                        </tr>
                        <tr>
                            <td><strong>toprak</strong></td>
                            <td>{{ results.pin_kodu_ozellikleri.toprak.esnek }}</td>
                            <td>{{ results.pin_kodu_ozellikleri.toprak.katı }}</td>
                            <td>{{ results.pin_kodu_ozellikleri.toprak.baskın }}</td>
                            <td>{{ results.pin_kodu_ozellikleri.toprak.edilgen }}</td>
                        </tr>
                        <tr>
                            <td><strong>ateş</strong></td>
                            <td>{{ results.pin_kodu_ozellikleri.ates.esnek }}</td>
                            <td>{{ results.pin_kodu_ozellikleri.ates.katı }}</td>
                            <td>{{ results.pin_kodu_ozellikleri.ates.baskın }}</td>
                            <td>{{ results.pin_kodu_ozellikleri.ates.edilgen }}</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    {% endif %}
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const dateInput = document.getElementById('dogum_gunu');
    const datePicker = document.getElementById('date_picker');

    // Date picker'dan text input'a
    datePicker.addEventListener('change', function(e) {
        if (e.target.value) {
            const date = new Date(e.target.value);
            const day = String(date.getDate()).padStart(2, '0');
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const year = date.getFullYear();
            dateInput.value = `${day}.${month}.${year}`;
        }
    });

    // Text input'tan date picker'a
    dateInput.addEventListener('input', function(e) {
        const value = e.target.value;
        // Tüm ayraçları nokta ile değiştir
        const normalized = value.replace(/[/\s-]/g, '.');
        const parts = normalized.split('.');
        
        if (parts.length === 3) {
            const day = parts[0].padStart(2, '0');
            const month = parts[1].padStart(2, '0');
            const year = parts[2];
            
            // Geçerli bir tarih mi kontrol et
            const date = new Date(year, month - 1, day);
            if (!isNaN(date) && date.getFullYear() == year) {
                datePicker.value = `${year}-${month}-${day}`;
            }
        }
    });
});

function toggleAccordion(button) {
    const item = button.parentElement;
    const isActive = item.classList.contains('active');
    
    // Tüm açık accordion'ları kapat
    document.querySelectorAll('.accordion-item').forEach(accordionItem => {
        accordionItem.classList.remove('active');
    });
    
    // Eğer tıklanan kapalıysa, onu aç
    if (!isActive) {
        item.classList.add('active');
    }
}
</script>

<style>
.pin-kodu-tablosu {
    margin: 10px 0;
}

.pin-kodu-tablosu table {
    border-collapse: separate;
    border-spacing: 10px;
    margin: 0;
}

.pin-kodu-tablosu td {
    padding: 5px 10px;
    text-align: center;
    font-size: 1.2em;
    min-width: 40px;
    border: none;
    background-color: transparent;
}

.pin-kodu-tablosu tr:first-child td {
    background-color: transparent;
    font-weight: normal;
}

.pin-kodu-yorum {
    background-color: #f8f9fa;
    padding: 15px;
    margin: 10px 0;
    border-radius: 5px;
    border-left: 4px solid #ff8c00;
    white-space: pre-line;
}

.pin-kodu-yorum:hover {
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

.result-section {
    background-color: #f8f9fa;
    padding: 15px;
    margin: 15px 0;
    border-radius: 5px;
}

.chakra-table {
    margin: 10px 0;
    overflow-x: auto;
    max-width: 100%;
}

.chakra-table table {
    border-collapse: separate;
    border-spacing: 10px;
    margin: 0;
    min-width: 600px;
}

.chakra-table td {
    padding: 5px 10px;
    text-align: center;
    font-family: monospace;
    font-size: 1.2em;
}

.chakra-table .plus-cell {
    color: #080808;
    min-width: 100px;
}

.chakra-table .plus-cell:first-child {
    text-align: right;
}

.chakra-table .plus-cell:nth-child(3) {
    text-align: left;
    padding-left: 0;
}

.chakra-table .number-cell {
    font-weight: bold;
    color: #1e1e1e;
    min-width: 40px;
}

.chakra-table .pin-code-cell {
    text-align: left;
    padding-left: 30px;
    min-width: 60px;
    color: #080808;
    font-weight: bold;
}

.chakra-table .separator-cell {
    color: #080808;
    min-width: 20px;
    text-align: center;
    font-weight: bold;
}

.chakra-table .ek-plus-cell {
    color: #080808;
    min-width: 100px;
    text-align: left;
    padding-left: 0;
    white-space: nowrap;
}

.accordion-item {
    margin-bottom: 10px;
    border: 1px solid #ddd;
    border-radius: 4px;
}

.accordion-button {
    width: 100%;
    padding: 15px;
    background-color: #f8f9fa;
    border: none;
    text-align: left;
    cursor: pointer;
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-size: 1em;
    color: #333;
    transition: background-color 0.3s;
}

.accordion-button:hover {
    background-color: #e9ecef;
}

.accordion-icon {
    font-size: 0.8em;
    transition: transform 0.3s;
}

.accordion-content {
    padding: 0 15px;
    max-height: 0;
    overflow: hidden;
    transition: max-height 0.3s ease-out;
    background-color: white;
    font-family: Arial, sans-serif;
    font-size: 1rem;
    line-height: 1.6;
}

.accordion-item.active .accordion-content {
    padding: 15px;
    max-height: none; /* İçeriğin tamamını göster */
    height: auto;
}

.accordion-item.active .accordion-icon {
    transform: rotate(180deg);
}

.accordion-content pre {
    font-family: Arial, sans-serif;
    font-size: 1rem;
    line-height: 1.6;
    white-space: pre-wrap;
    background-color: transparent;
    padding: 0;
    margin: 0;
}

.result-section pre {
    font-family: Arial, sans-serif;
    font-size: 1rem;
    line-height: 1.6;
    white-space: pre-wrap;
    background-color: #f8f9fa;
    padding: 1.5rem;
    border-radius: 6px;
}

/* Responsive design for mobile */
@media (max-width: 768px) {
    .chakra-table {
        overflow-x: scroll;
        -webkit-overflow-scrolling: touch;
    }
    
    .chakra-table table {
        min-width: 500px;
        border-spacing: 5px;
    }
    
    .chakra-table td {
        padding: 3px 5px;
        font-size: 1em;
    }
    
    .chakra-table .plus-cell {
        min-width: 70px;
    }
    
    .chakra-table .ek-plus-cell {
        min-width: 70px;
    }
    
    .chakra-table .pin-code-cell {
        padding-left: 15px;
        min-width: 40px;
    }
    
    .result-section {
        padding: 10px;
    }
    
    .pin-kodu-tablosu {
        overflow-x: auto;
        -webkit-overflow-scrolling: touch;
    }
    
    .pin-kodu-tablosu table {
        min-width: 300px;
        border-spacing: 5px;
    }
    
    .pin-kodu-tablosu td {
        padding: 3px 5px;
        font-size: 1em;
        min-width: 30px;
    }
}

.mizac-tablosu {
    margin: 10px 0;
    overflow-x: auto;
}

.mizac-tablosu table {
    border-collapse: separate;
    border-spacing: 6px;
    margin: 0;
    width: 100%;
    max-width: 650px;
}

.mizac-tablosu td {
    padding: 4px 7px;
    text-align: center;
    font-size: 1em;
    min-width: 30px;
    border: none;
    background-color: transparent;
}

.mizac-tablosu th {
    padding: 3px 6px;
    text-align: center;
    font-size: 0.8em;
    font-weight: bold;
    min-width: 30px;
}
</style>
{% endblock %} 